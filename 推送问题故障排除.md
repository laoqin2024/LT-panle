# æ¨é€é—®é¢˜æ•…éšœæ’é™¤æŒ‡å—

## ğŸ” é—®é¢˜ï¼šæ¨é€å¡ä½æˆ–åœæ­¢

å¦‚æœåŒæ­¥è„šæœ¬åœ¨æ¨é€åˆ° Giteeï¼ˆæˆ– GitHubï¼‰æ—¶å¡ä½ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

---

## ğŸ“‹ å¿«é€Ÿè¯Šæ–­

### 1. è¿è¡Œè¯Šæ–­è„šæœ¬

```bash
# è¿è¡Œé…ç½®æ£€æŸ¥è„šæœ¬
./check_git_config.sh
```

è¿™ä¸ªè„šæœ¬ä¼šæ£€æŸ¥ï¼š
- Git é…ç½®
- è¿œç¨‹ä»“åº“é…ç½®
- ç½‘ç»œè¿æ¥
- SSH å¯†é’¥é…ç½®
- åˆ†æ”¯çŠ¶æ€

---

## ğŸ”§ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: æ¨é€å¡ä½ï¼Œæ²¡æœ‰å“åº”

**ç—‡çŠ¶ï¼š** è„šæœ¬åœ¨æ¨é€æ—¶å¡ä½ï¼Œæ²¡æœ‰ä»»ä½•è¾“å‡º

**å¯èƒ½åŸå› ï¼š**
- éœ€è¦è¾“å…¥å¯†ç æˆ– tokenï¼Œä½†è„šæœ¬æ²¡æœ‰æ˜¾ç¤ºæç¤º
- ç½‘ç»œè¿æ¥é—®é¢˜
- è®¤è¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**

#### æ–¹æ¡ˆ A: ä½¿ç”¨ SSH å¯†é’¥ï¼ˆæ¨èï¼‰

```bash
# 1. æ£€æŸ¥æ˜¯å¦å·²æœ‰ SSH å¯†é’¥
ls -la ~/.ssh/

# 2. å¦‚æœæ²¡æœ‰ï¼Œç”Ÿæˆæ–°çš„ SSH å¯†é’¥
ssh-keygen -t ed25519 -C "your_email@example.com"
# æŒ‰ Enter ä½¿ç”¨é»˜è®¤è·¯å¾„
# å¯ä»¥è®¾ç½®å¯†ç æˆ–ç•™ç©º

# 3. æŸ¥çœ‹å…¬é’¥
cat ~/.ssh/id_ed25519.pub

# 4. å°†å…¬é’¥æ·»åŠ åˆ° GitHub
# è®¿é—®: https://github.com/settings/keys
# ç‚¹å‡» "New SSH key"ï¼Œç²˜è´´å…¬é’¥å†…å®¹

# 5. å°†å…¬é’¥æ·»åŠ åˆ° Gitee
# è®¿é—®: https://gitee.com/profile/sshkeys
# ç‚¹å‡» "æ·»åŠ å…¬é’¥"ï¼Œç²˜è´´å…¬é’¥å†…å®¹

# 6. ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€ä¸º SSH æ ¼å¼
git remote set-url github git@github.com:ç”¨æˆ·å/ä»“åº“å.git
git remote set-url gitee git@gitee.com:ç”¨æˆ·å/ä»“åº“å.git

# 7. æµ‹è¯•è¿æ¥
ssh -T git@github.com
ssh -T git@gitee.com
```

#### æ–¹æ¡ˆ B: ä½¿ç”¨ Personal Access Token

```bash
# 1. ç”Ÿæˆ GitHub Personal Access Token
# è®¿é—®: https://github.com/settings/tokens
# ç‚¹å‡» "Generate new token (classic)"
# é€‰æ‹©æƒé™: repo (å…¨éƒ¨)
# å¤åˆ¶ç”Ÿæˆçš„ token

# 2. ç”Ÿæˆ Gitee Personal Access Token
# è®¿é—®: https://gitee.com/profile/personal_access_tokens
# ç‚¹å‡» "ç”Ÿæˆæ–°ä»¤ç‰Œ"
# é€‰æ‹©æƒé™: projects
# å¤åˆ¶ç”Ÿæˆçš„ token

# 3. é…ç½® Git å‡­æ®å­˜å‚¨
git config --global credential.helper osxkeychain  # macOS
# æˆ–
git config --global credential.helper store       # Linux

# 4. æ¨é€æ—¶ä½¿ç”¨ token ä½œä¸ºå¯†ç 
# ç”¨æˆ·å: ä½ çš„ GitHub/Gitee ç”¨æˆ·å
# å¯†ç : ç²˜è´´åˆšæ‰å¤åˆ¶çš„ token
```

#### æ–¹æ¡ˆ C: ä½¿ç”¨è·³è¿‡é€‰é¡¹

å¦‚æœ Gitee æ¨é€ä¸€ç›´å¡ä½ï¼Œå¯ä»¥å…ˆè·³è¿‡ï¼š

```bash
# åªæ¨é€åˆ° GitHub
./sync_repos.sh "æäº¤ä¿¡æ¯" --skip-gitee

# æˆ–åªæ¨é€åˆ° Gitee
./sync_repos.sh "æäº¤ä¿¡æ¯" --skip-github
```

---

### é—®é¢˜ 2: è®¤è¯å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
remote: Support for password authentication was removed
fatal: Authentication failed
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ä½¿ç”¨ SSH å¯†é’¥**ï¼ˆè§é—®é¢˜ 1 çš„æ–¹æ¡ˆ Aï¼‰

2. **ä½¿ç”¨ Personal Access Token**ï¼ˆè§é—®é¢˜ 1 çš„æ–¹æ¡ˆ Bï¼‰

3. **æ¸…é™¤ç¼“å­˜çš„å‡­æ®ï¼š**
   ```bash
   # macOS
   git credential-osxkeychain erase
   host=github.com
   protocol=https
   # æŒ‰ Ctrl+D ç»“æŸè¾“å…¥
   
   # æˆ–åˆ é™¤å‡­æ®æ–‡ä»¶
   rm ~/.git-credentials
   ```

---

### é—®é¢˜ 3: ç½‘ç»œè¿æ¥è¶…æ—¶

**é”™è¯¯ä¿¡æ¯ï¼š**
```
fatal: unable to access 'https://gitee.com/...': Operation timed out
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼š**
   ```bash
   # æµ‹è¯• GitHub è¿æ¥
   ping github.com
   
   # æµ‹è¯• Gitee è¿æ¥
   ping gitee.com
   ```

2. **ä½¿ç”¨ä»£ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š**
   ```bash
   # è®¾ç½® HTTP ä»£ç†
   git config --global http.proxy http://proxy.example.com:8080
   git config --global https.proxy https://proxy.example.com:8080
   
   # å–æ¶ˆä»£ç†
   git config --global --unset http.proxy
   git config --global --unset https.proxy
   ```

3. **Gitee ç‰¹æ®Šè¯´æ˜ï¼š**
   - Gitee åœ¨å›½å†…è®¿é—®æ›´å¿«
   - å¦‚æœåœ¨å›½å¤–ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ VPN æˆ–ä»£ç†
   - è€ƒè™‘åªä½¿ç”¨ GitHubï¼Œæˆ–ä½¿ç”¨ Gitee çš„é•œåƒæœåŠ¡

---

### é—®é¢˜ 4: åˆ†æ”¯ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯ï¼š**
```
error: src refspec main does not exist
```

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# 1. æŸ¥çœ‹å½“å‰åˆ†æ”¯
git branch

# 2. å¦‚æœå½“å‰åˆ†æ”¯ä¸æ˜¯ mainï¼Œåˆ‡æ¢åˆ° main
git checkout -b main

# 3. æˆ–è€…æ¨é€åˆ°å½“å‰åˆ†æ”¯
git push github $(git branch --show-current)
```

---

### é—®é¢˜ 5: è¿œç¨‹åˆ†æ”¯å·²å­˜åœ¨ä½†ä¸åŒæ­¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
error: failed to push some refs to 'github'
hint: Updates were rejected because the remote contains work...
```

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# 1. å…ˆæ‹‰å–è¿œç¨‹æ›´æ”¹
git pull github main

# 2. è§£å†³å¯èƒ½çš„å†²çª
# ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œç„¶åï¼š
git add .
git commit -m "è§£å†³å†²çª"

# 3. å†æ¨é€
git push github main
```

---

## ğŸ› ï¸ æ‰‹åŠ¨æ¨é€æ­¥éª¤

å¦‚æœè„šæœ¬ä¸€ç›´å¡ä½ï¼Œå¯ä»¥æ‰‹åŠ¨æ¨é€ï¼š

### 1. æ£€æŸ¥çŠ¶æ€

```bash
# æŸ¥çœ‹å½“å‰çŠ¶æ€
git status

# æŸ¥çœ‹è¿œç¨‹ä»“åº“
git remote -v

# æŸ¥çœ‹å½“å‰åˆ†æ”¯
git branch
```

### 2. æ‰‹åŠ¨æ¨é€

```bash
# æ¨é€åˆ° GitHub
git push github main

# æ¨é€åˆ° Gitee
git push gitee main
```

### 3. å¦‚æœæ¨é€éœ€è¦è®¤è¯

- **SSH æ–¹å¼ï¼š** ç¡®ä¿ SSH å¯†é’¥å·²é…ç½®
- **HTTPS æ–¹å¼ï¼š** è¾“å…¥ç”¨æˆ·åå’Œ Personal Access Token

---

## ğŸ” é…ç½® SSH å¯†é’¥ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰

### æ­¥éª¤ 1: ç”Ÿæˆ SSH å¯†é’¥

```bash
# ç”Ÿæˆæ–°çš„ SSH å¯†é’¥
ssh-keygen -t ed25519 -C "your_email@example.com"

# å¦‚æœç³»ç»Ÿä¸æ”¯æŒ ed25519ï¼Œä½¿ç”¨ RSA
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# æŒ‰ Enter ä½¿ç”¨é»˜è®¤è·¯å¾„ (~/.ssh/id_ed25519)
# å¯ä»¥è®¾ç½®å¯†ç æˆ–ç•™ç©º
```

### æ­¥éª¤ 2: å¯åŠ¨ SSH ä»£ç†

```bash
# å¯åŠ¨ ssh-agent
eval "$(ssh-agent -s)"

# æ·»åŠ  SSH å¯†é’¥åˆ° ssh-agent
ssh-add ~/.ssh/id_ed25519
```

### æ­¥éª¤ 3: å¤åˆ¶å…¬é’¥

```bash
# å¤åˆ¶å…¬é’¥åˆ°å‰ªè´´æ¿ï¼ˆmacOSï¼‰
pbcopy < ~/.ssh/id_ed25519.pub

# æˆ–æ˜¾ç¤ºå…¬é’¥å†…å®¹
cat ~/.ssh/id_ed25519.pub
```

### æ­¥éª¤ 4: æ·»åŠ åˆ° GitHub

1. è®¿é—® https://github.com/settings/keys
2. ç‚¹å‡» "New SSH key"
3. å¡«å†™ Titleï¼ˆä¾‹å¦‚ï¼šMy Macï¼‰
4. ç²˜è´´å…¬é’¥å†…å®¹
5. ç‚¹å‡» "Add SSH key"

### æ­¥éª¤ 5: æ·»åŠ åˆ° Gitee

1. è®¿é—® https://gitee.com/profile/sshkeys
2. ç‚¹å‡» "æ·»åŠ å…¬é’¥"
3. å¡«å†™æ ‡é¢˜ï¼ˆä¾‹å¦‚ï¼šMy Macï¼‰
4. ç²˜è´´å…¬é’¥å†…å®¹
5. ç‚¹å‡» "ç¡®å®š"

### æ­¥éª¤ 6: æµ‹è¯•è¿æ¥

```bash
# æµ‹è¯• GitHub
ssh -T git@github.com
# åº”è¯¥çœ‹åˆ°: Hi username! You've successfully authenticated...

# æµ‹è¯• Gitee
ssh -T git@gitee.com
# åº”è¯¥çœ‹åˆ°: Hi username! You've successfully authenticated...
```

### æ­¥éª¤ 7: ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€

```bash
# ä¿®æ”¹ä¸º SSH åœ°å€
git remote set-url github git@github.com:ç”¨æˆ·å/ä»“åº“å.git
git remote set-url gitee git@gitee.com:ç”¨æˆ·å/ä»“åº“å.git

# éªŒè¯
git remote -v
```

---

## ğŸ“ ä½¿ç”¨è„šæœ¬é€‰é¡¹

å¦‚æœæŸä¸ªè¿œç¨‹ä»“åº“ä¸€ç›´æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬çš„è·³è¿‡é€‰é¡¹ï¼š

```bash
# åªæ¨é€åˆ° GitHubï¼ˆè·³è¿‡ Giteeï¼‰
./sync_repos.sh "æäº¤ä¿¡æ¯" --skip-gitee

# åªæ¨é€åˆ° Giteeï¼ˆè·³è¿‡ GitHubï¼‰
./sync_repos.sh "æäº¤ä¿¡æ¯" --skip-github

# åªæ¨é€åˆ° GitHub
./sync_repos.sh "æäº¤ä¿¡æ¯" --github-only

# åªæ¨é€åˆ° Gitee
./sync_repos.sh "æäº¤ä¿¡æ¯" --gitee-only
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹è¯¦ç»†è¾“å‡º

```bash
# ä½¿ç”¨ -v å‚æ•°æŸ¥çœ‹è¯¦ç»†è¾“å‡º
git push -v github main
git push -v gitee main
```

### 2. æµ‹è¯•è¿æ¥

```bash
# æµ‹è¯• GitHub
git ls-remote github

# æµ‹è¯• Gitee
git ls-remote gitee
```

### 3. æ£€æŸ¥ç½‘ç»œ

```bash
# æµ‹è¯•ç½‘ç»œè¿æ¥
curl -I https://github.com
curl -I https://gitee.com
```

---

## ğŸ“ è·å–æ›´å¤šå¸®åŠ©

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼š

1. **è¿è¡Œè¯Šæ–­è„šæœ¬ï¼š**
   ```bash
   ./check_git_config.sh
   ```

2. **æŸ¥çœ‹ Git å¸®åŠ©ï¼š**
   ```bash
   git help push
   git help remote
   ```

3. **æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š**
   - GitHub: https://docs.github.com/en/authentication
   - Gitee: https://gitee.com/help/articles/4191

---

## âœ… æ£€æŸ¥æ¸…å•

æ¨é€å‰è¯·ç¡®è®¤ï¼š

- [ ] Git ç”¨æˆ·ä¿¡æ¯å·²é…ç½®
- [ ] è¿œç¨‹ä»“åº“åœ°å€æ­£ç¡®
- [ ] SSH å¯†é’¥å·²é…ç½®å¹¶æ·»åŠ åˆ° GitHub/Gitee
- [ ] æˆ– Personal Access Token å·²é…ç½®
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸
- [ ] å½“å‰åˆ†æ”¯å­˜åœ¨
- [ ] å·¥ä½œåŒºå·²æäº¤æ‰€æœ‰æ›´æ”¹

---

**æœ€åæ›´æ–°ï¼š** 2024å¹´
