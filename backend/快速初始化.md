# 数据库快速初始化指南

## 一键初始化（推荐）

```bash
cd backend
bash scripts/init_database.sh
```

这个脚本会自动完成所有初始化步骤。

---

## 手动初始化步骤

### 步骤1: 启用 TimescaleDB 扩展

```bash
cd backend
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "CREATE EXTENSION IF NOT EXISTS timescaledb;"
```

### 步骤2: 创建 TimescaleDB 时序表

```bash
docker-compose exec -T postgres psql -U laoqin -d laoqin_panel < scripts/create_timescaledb_tables.sql
```

### 步骤3: 初始化业务数据表

```bash
# 激活虚拟环境
source venv-panle/bin/activate

# 运行初始化脚本
python scripts/init_db.py
```

---

## 验证初始化

```bash
# 检查表数量（应该有很多表）
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'public';"

# 检查用户（应该有 admin 用户）
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT username, email FROM users;"

# 检查角色（应该有 admin 和 user）
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT name, description FROM roles;"

# 检查 TimescaleDB 超表（应该有4个）
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT hypertable_name FROM timescaledb_information.hypertables;"
```

---

## 默认账号

- **用户名**: `admin`
- **密码**: `admin123`
- ⚠️ **首次登录后请立即修改密码！**

