# æ•°æ®åº“åˆå§‹åŒ–å®Œæˆæ€»ç»“

## âœ… åˆå§‹åŒ–çŠ¶æ€

### å·²å®Œæˆçš„æ­¥éª¤

1. âœ… **TimescaleDB æ‰©å±•å·²å¯ç”¨**
2. âœ… **TimescaleDB æ—¶åºè¡¨å·²åˆ›å»º**ï¼ˆ4ä¸ªè¶…è¡¨ï¼‰
3. âœ… **ä¸šåŠ¡æ•°æ®è¡¨å·²åˆ›å»º**ï¼ˆ29ä¸ªè¡¨ï¼‰
4. âœ… **åˆå§‹æ•°æ®å·²åˆ›å»º**ï¼ˆè§’è‰²ã€æƒé™ã€ç”¨æˆ·ï¼‰

---

## ğŸ“Š æ•°æ®åº“ç»Ÿè®¡

### è¡¨æ•°é‡
- **ä¸šåŠ¡è¡¨**: 29ä¸ª
- **TimescaleDB è¶…è¡¨**: 4ä¸ª
  - server_metricsï¼ˆæœåŠ¡å™¨ç›‘æ§æŒ‡æ ‡ï¼‰
  - device_metricsï¼ˆè®¾å¤‡ç›‘æ§æŒ‡æ ‡ï¼‰
  - site_availabilityï¼ˆç«™ç‚¹å¯ç”¨æ€§ï¼‰
  - database_metricsï¼ˆæ•°æ®åº“ç›‘æ§æŒ‡æ ‡ï¼‰

### å·²åˆ›å»ºçš„æ•°æ®

#### è§’è‰²
- `admin` - ç®¡ç†å‘˜
- `user` - æ™®é€šç”¨æˆ·

#### æƒé™
- server:create, server:read, server:update, server:delete
- device:create, device:read, device:update, device:delete
- database:create, database:read, database:update, database:delete

#### ç”¨æˆ·
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin123`
- **é‚®ç®±**: `admin@example.com`
- **è§’è‰²**: `admin`
- âš ï¸ **é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼**

---

## ğŸ” éªŒè¯å‘½ä»¤

### æ£€æŸ¥è¡¨
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "\dt"
```

### æ£€æŸ¥ç”¨æˆ·
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT username, email, is_active FROM users;"
```

### æ£€æŸ¥è§’è‰²
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT name, description FROM roles;"
```

### æ£€æŸ¥ TimescaleDB è¶…è¡¨
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT hypertable_name FROM timescaledb_information.hypertables;"
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend
source venv-panle/bin/activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. è®¿é—® API æ–‡æ¡£

- **Swagger UI**: http://localhost:8000/api/docs
- **ReDoc**: http://localhost:8000/api/redoc

### 3. æµ‹è¯•ç™»å½•

ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

### 4. ä¿®æ”¹é»˜è®¤å¯†ç 

ç™»å½•åç«‹å³ä¿®æ”¹ç®¡ç†å‘˜å¯†ç ï¼

---

## ğŸ“ æ•°æ®åº“è¿æ¥ä¿¡æ¯

### Docker å®¹å™¨
- **ä¸»æœº**: localhost
- **ç«¯å£**: 5432
- **æ•°æ®åº“**: laoqin_panel
- **ç”¨æˆ·å**: laoqin
- **å¯†ç **: password

### è¿æ¥å­—ç¬¦ä¸²
```
postgresql+asyncpg://laoqin:password@localhost:5432/laoqin_panel
```

---

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### å¤‡ä»½æ•°æ®åº“
```bash
docker-compose exec postgres pg_dump -U laoqin laoqin_panel > backup_$(date +%Y%m%d_%H%M%S).sql
```

### æ¢å¤æ•°æ®åº“
```bash
docker-compose exec -T postgres psql -U laoqin -d laoqin_panel < backup.sql
```

### æŸ¥çœ‹æ•°æ®åº“å¤§å°
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT pg_size_pretty(pg_database_size('laoqin_panel'));"
```

### æŸ¥çœ‹è¡¨å¤§å°
```bash
docker-compose exec postgres psql -U laoqin -d laoqin_panel -c "SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size FROM pg_tables WHERE schemaname = 'public' ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;"
```

---

## âœ… åˆå§‹åŒ–å®Œæˆï¼

æ•°æ®åº“å·²å®Œå…¨åˆå§‹åŒ–ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨åç«¯æœåŠ¡äº†ã€‚

